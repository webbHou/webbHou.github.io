---
title: '移动端返回上一页'
date: 2017-08-31 13:24:19
tags:
	- javascript
	- 移动端
categories: 
	- js常见问题
---

## 移动端返回上一页问题

实际工作中往往有这样的需求,需要返回上一页。

### pc

在pc上我们可以使用window.history.go(-1)或者window.history.back()都可以实现需求,而无需知道上一页的具体url。

``` bash
<a href="javascript:history.go(-1)" class="header-back jsBack">返回</a>
```
``` bash
<a href="javascript:history.back()" class="header-back jsBack">返回</a>
```

### 移动端

但是在移动端，如果想要返回上一页。比如从A页面跳到B页面，如果B页面想返回A页面，为了防止不会跳错，必须要有一个 <  按钮，给它加 history.go(-1) ，返回上一层。

``` bash
<a href="javascript:history.go(-1)" class="header-back jsBack">返回</a>
```

但链接来源错综复杂，往往有些情况下根本没有上一页,这时候点击返回按钮根本没有用,用户体验性很差。很多时候会以为只是一个BUG。

移动端无论是原生app还是传统的网页，返回上页是一个比较强烈的需求。

``` bash
javascript 有一个可以获取前一页面的URL地址的方法：document.referrer
```

允许客户端通过document.referrer访问http头部来获取当前网页的来源。

根据document.referrer 的来源来判断是否有来源信息，如果来源信息为空，则返回首页：

``` bash
if (typeof document.referrer === '') {
    // 没有来源页面信息的时候，改成首页URL地址
    $('.jsBack').attr('href', '/');
}
```

以此来达到返回上一页的效果。


### 无法获取referrer

下面的场景无法获得 referrer 信息，以下前8条属于【张鑫旭】：

``` bash
直接在浏览器中输入地址
使用location.reload()刷新（location.href或者location.replace()刷新有信息）
在微信对话框中，点击进入微信自身浏览器
扫码进入微信或QQ的浏览器
直接新窗口打开一个页面
从https的网站直接进入一个http协议的网站（Chrome下亲测）
a标签设置rel="noreferrer"（兼容IE7+）
meta标签来控制不让浏览器发送referer
点击 flash 内部链接
Chrome4.0以下，IE 5.5+以下返回空的字符串
使用 修改 Location 进行页面导航的方法，会导致在IE下丢失 referrer，这可能是IE的一个BUG
跨域
<meta content="never" name="referrer">
```
