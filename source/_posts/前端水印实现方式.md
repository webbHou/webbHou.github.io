---
title: 前端水印实现方式
tags:
  - javascript
categories: js常见问题
date: 2021-08-26 11:19:38
---

#### 重复dom覆盖和canvas背景图

这两种都是通过css的方式给图片上层覆盖一层水印，容易被破坏。

#### Canvas写入方式

```javascript
function __picWM({
  url = '',
  textAlign = 'center',
  textBaseline = 'middle',
  font = "20px Microsoft Yahei",
  fillStyle = 'rgba(184, 184, 184, 0.8)',
  content = '水印',
  cb = null,
  textX = 100,
  textY = 30
} = {}) {
  const img = new Image();
  img.src = url;
  img.crossOrigin = 'anonymous';
  img.onload = function() {
        const canvas = document.createElement('canvas');
        canvas.width = img.width;
        canvas.height = img.height;
        const ctx = canvas.getContext('2d');

        ctx.drawImage(img, 0, 0);
        ctx.textAlign = textAlign;
        ctx.textBaseline = textBaseline;
        ctx.font = font;
        ctx.fillStyle = fillStyle;
        ctx.fillText(content, img.width - textX, img.height - textY);

        const base64Url = canvas.toDataURL();
        cb && cb(base64Url);
  }
}

__picWM({
  url: '',
  content: '水印',
  ca: (img) => {
    console.log(img)
  }
})
```

#### Svg方式

#### 隐形水印

计算出图片的rgb值，然后进行微小的改变生成水印字体色，然后写入水印。输出后肉眼看不出水印，但解密处理后可以看到。
